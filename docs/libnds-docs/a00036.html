<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>libnds: Graphics/3D/Display_List/source/main.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="docs.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Graphics/3D/Display_List/source/main.cpp</h1><div class="fragment"><pre class="fragment"><span class="preprocessor">#include &lt;<a class="code" href="a00119.html" title="the master include file for nds applications.">nds.h</a>&gt;</span>


<span class="comment">//display list</span>
<a name="a0"></a><a class="code" href="a00121.html#afaa62991928fb9fb18ff0db62a040aba" title="32 bit unsigned integer.">u32</a> triangle[] = 
{
    12,
    <a name="a1"></a><a class="code" href="a00136.html#aa98c38e196fa1c53a3bf5b8642abd2db" title="packs four packed commands into a 32bit command for sending to the GFX FIFO">FIFO_COMMAND_PACK</a>(<a name="a2"></a><a class="code" href="a00136.html#a8b805f6d2ddd0eb3ea56f7084ee8b555" title="packed command that starts a polygon vertex list GBATEK http://nocash.emubase.de/gbatek...">FIFO_BEGIN</a>, <a name="a3"></a><a class="code" href="a00136.html#a6129334edbf8c984517413b2fd6656ba" title="packed command for vertex color directly GBATEK http://nocash.emubase.de/gbatek.htm#ds3dpolygonattri...">FIFO_COLOR</a>, <a name="a4"></a><a class="code" href="a00136.html#aaf09eca530e4cef70635611e239f1a4b" title="packed command for a vertex with 3 16bit paramaters(and 16bits of padding) GBATEK...">FIFO_VERTEX16</a>, <a class="code" href="a00136.html#a6129334edbf8c984517413b2fd6656ba" title="packed command for vertex color directly GBATEK http://nocash.emubase.de/gbatek.htm#ds3dpolygonattri...">FIFO_COLOR</a>),
    <a name="a5"></a><a class="code" href="a00136.html#a0e589918d10f56cda0c48e6f1dd389e9a2e039d879e6eb8e32f09d7a4548626b7">GL_TRIANGLE</a>,
    <a name="a6"></a><a class="code" href="a00135.html#abd4530c7880d389c9ea70e2e3b84aa9d" title="Macro to convert 5 bit r g b components into a single 15 bit RGB triplet.">RGB15</a>(31,0,0),
    <a name="a7"></a><a class="code" href="a00136.html#a164d88cf058b50148456f0504341f375" title="Pack to v16 values into one 32bit value.">VERTEX_PACK</a>(<a name="a8"></a><a class="code" href="a00136.html#a651e9d9f951be571b2a92aed6ecd4bcb" title="convert int to v16">inttov16</a>(-1),<a class="code" href="a00136.html#a651e9d9f951be571b2a92aed6ecd4bcb" title="convert int to v16">inttov16</a>(-1)), <a class="code" href="a00136.html#a164d88cf058b50148456f0504341f375" title="Pack to v16 values into one 32bit value.">VERTEX_PACK</a>(0,0),
    <a class="code" href="a00135.html#abd4530c7880d389c9ea70e2e3b84aa9d" title="Macro to convert 5 bit r g b components into a single 15 bit RGB triplet.">RGB15</a>(0,31,0),
    <a class="code" href="a00136.html#aa98c38e196fa1c53a3bf5b8642abd2db" title="packs four packed commands into a 32bit command for sending to the GFX FIFO">FIFO_COMMAND_PACK</a>(<a class="code" href="a00136.html#aaf09eca530e4cef70635611e239f1a4b" title="packed command for a vertex with 3 16bit paramaters(and 16bits of padding) GBATEK...">FIFO_VERTEX16</a>, <a class="code" href="a00136.html#a6129334edbf8c984517413b2fd6656ba" title="packed command for vertex color directly GBATEK http://nocash.emubase.de/gbatek.htm#ds3dpolygonattri...">FIFO_COLOR</a>, <a class="code" href="a00136.html#aaf09eca530e4cef70635611e239f1a4b" title="packed command for a vertex with 3 16bit paramaters(and 16bits of padding) GBATEK...">FIFO_VERTEX16</a>, <a name="a9"></a><a class="code" href="a00136.html#a65a2180ea9fbef1f6f96b2861b88939c" title="packed command that has no discernable effect, it&amp;#39;s probably best to never use...">FIFO_END</a>),
    <a class="code" href="a00136.html#a164d88cf058b50148456f0504341f375" title="Pack to v16 values into one 32bit value.">VERTEX_PACK</a>(<a class="code" href="a00136.html#a651e9d9f951be571b2a92aed6ecd4bcb" title="convert int to v16">inttov16</a>(1),<a class="code" href="a00136.html#a651e9d9f951be571b2a92aed6ecd4bcb" title="convert int to v16">inttov16</a>(-1)), <a class="code" href="a00136.html#a164d88cf058b50148456f0504341f375" title="Pack to v16 values into one 32bit value.">VERTEX_PACK</a>(0,0),
    <a class="code" href="a00135.html#abd4530c7880d389c9ea70e2e3b84aa9d" title="Macro to convert 5 bit r g b components into a single 15 bit RGB triplet.">RGB15</a>(0,0,31),
    <a class="code" href="a00136.html#a164d88cf058b50148456f0504341f375" title="Pack to v16 values into one 32bit value.">VERTEX_PACK</a>(<a class="code" href="a00136.html#a651e9d9f951be571b2a92aed6ecd4bcb" title="convert int to v16">inttov16</a>(0),<a class="code" href="a00136.html#a651e9d9f951be571b2a92aed6ecd4bcb" title="convert int to v16">inttov16</a>(1)), <a class="code" href="a00136.html#a164d88cf058b50148456f0504341f375" title="Pack to v16 values into one 32bit value.">VERTEX_PACK</a>(0,0),
};

<span class="keywordtype">int</span> main()
{   
    
    <span class="keywordtype">float</span> rotateX = 0.0;
    <span class="keywordtype">float</span> rotateY = 0.0;
    
    <span class="comment">//set mode 0, enable BG0 and set it to 3D</span>
    <a name="a10"></a><a class="code" href="a00135.html#ae3ea5c2e57cc40d6a88e21c4dcb742c8" title="the main 2D engine video mode">videoSetMode</a>(<a name="a11"></a><a class="code" href="a00135.html#a1e46218ee302fcc8c77e4ea0968ea149af75d73d6670d95a0cec81b8e648a0dca" title="3 2D backgrounds 1 3D background (Main engine only)">MODE_0_3D</a>);
    
    <span class="comment">// initialize gl</span>
    <a name="a12"></a><a class="code" href="a00136.html#a29390b4085e778ee80b07b46efd4b2ca" title="Initializes the gl state machine (must be called once before using gl calls).">glInit</a>();
    
    <span class="comment">// enable antialiasing</span>
    <a name="a13"></a><a class="code" href="a00136.html#acc179be4d402924ed239617a6aa422f2" title="Enables various gl states (blend, alpha test, etc..).">glEnable</a>(<a name="a14"></a><a class="code" href="a00136.html#a09e37320519ef82d47501185b7a76931aeb3eb07748974534a5a9ab69d190a3ad">GL_ANTIALIAS</a>);
    
    <span class="comment">// setup the rear plane</span>
    <a name="a15"></a><a class="code" href="a00136.html#a47af9a2279197ba4d95467cc0741f117" title="sets the color of the rear-plane(a.k.a Clear Color/Plane)">glClearColor</a>(0,0,0,31); <span class="comment">// BG must be opaque for AA to work</span>
    <a name="a16"></a><a class="code" href="a00136.html#a0316399378018c0409a78580cb1166a9" title="sets the polygon ID of the rear-plane(a.k.a. Clear/Color Plane), useful for antialiasing...">glClearPolyID</a>(63); <span class="comment">// BG must have a unique polygon ID for AA to work</span>
    <a name="a17"></a><a class="code" href="a00136.html#acf0b19102499eed4547a6cac367e51ef" title="reset the depth buffer to this value; generally set this to GL_MAX_DEPTH.  GBATEK...">glClearDepth</a>(0x7FFF);
    
    <span class="comment">//this should work the same as the normal gl call</span>
    <a name="a18"></a><a class="code" href="a00136.html#a2dca9bf8f906cf5d97f7c11b6e7f3505" title="specify the viewport for following drawing, can be set several times per frame. ...">glViewport</a>(0,0,255,191);
    
    
    <a name="a19"></a><a class="code" href="a00136.html#a0735cc3f765138aeda473865ee1ecce6" title="change the current matrix mode  GBATEK http://nocash.emubase.de/gbatek.htm#ds3dmatrixloadmultiply...">glMatrixMode</a>(<a name="a20"></a><a class="code" href="a00136.html#a2d4b5d945cec30e7c025823f0447c2b4a9f052b4ec4987e02bae380daff5fa634">GL_PROJECTION</a>);
    <a name="a21"></a><a class="code" href="a00136.html#a3dbf4d6316eb7640e507572fe2612b70" title="loads an identity matrix to the current matrix, same as glIdentity(void)">glLoadIdentity</a>();
    <a name="a22"></a><a class="code" href="a00136.html#ab40589d7691759f889108bd71fbf10b1" title="Utility function which sets up the projection matrix (floating point version).">gluPerspective</a>(70, 256.0 / 192.0, 0.1, 40);
    
    <a name="a23"></a><a class="code" href="a00136.html#ae379e6b9371e46316838a1940478745f" title="Places the camera at the specified location and orientation (floating point version)...">gluLookAt</a>(  0.0, 0.0, 1.0,      <span class="comment">//camera possition </span>
                0.0, 0.0, 0.0,      <span class="comment">//look at</span>
                0.0, 1.0, 0.0);     <span class="comment">//up</span>
    
    <span class="keywordflow">while</span>(1)        
    {
        <a name="a24"></a><a class="code" href="a00136.html#adc07d63d8e4fdf97bed3e6c5199b9ced" title="Pushes the current matrix onto the stack  GBATEK http://nocash.emubase.de/gbatek...">glPushMatrix</a>();
        
        <span class="comment">//move it away from the camera</span>
        <a name="a25"></a><a class="code" href="a00136.html#a7f6720ea6912f35076972a53ceaf474b" title="multiply the current matrix by a translation matrix  GBATEK http://nocash.emubase...">glTranslate3f32</a>(0, 0, <a name="a26"></a><a class="code" href="a00136.html#a0de6472aed67db4b02eb02bd23f37b62" title="convert float to f32">floattof32</a>(-1));
        
        <a name="a27"></a><a class="code" href="a00136.html#ae476e8ac218773a112f5343ef4853847" title="Rotates the current modelview matrix by angle degrees about the x axis.">glRotateX</a>(rotateX);
        <a name="a28"></a><a class="code" href="a00136.html#a694ce5cca1107c293c444e216240317a" title="Rotates the current modelview matrix by angle degrees about the y axis.">glRotateY</a>(rotateY);
        
        <a class="code" href="a00136.html#a0735cc3f765138aeda473865ee1ecce6" title="change the current matrix mode  GBATEK http://nocash.emubase.de/gbatek.htm#ds3dmatrixloadmultiply...">glMatrixMode</a>(<a name="a29"></a><a class="code" href="a00136.html#a2d4b5d945cec30e7c025823f0447c2b4ac065907926aef873cd49693fb8b34d45">GL_TEXTURE</a>);
        <a class="code" href="a00136.html#a3dbf4d6316eb7640e507572fe2612b70" title="loads an identity matrix to the current matrix, same as glIdentity(void)">glLoadIdentity</a>();
        
        <a class="code" href="a00136.html#a0735cc3f765138aeda473865ee1ecce6" title="change the current matrix mode  GBATEK http://nocash.emubase.de/gbatek.htm#ds3dmatrixloadmultiply...">glMatrixMode</a>(<a name="a30"></a><a class="code" href="a00136.html#a2d4b5d945cec30e7c025823f0447c2b4ab61b6af2524c193dafa434f0d39d5fbb">GL_MODELVIEW</a>);
        
        
        <span class="comment">//not a real gl function and will likely change</span>
        <a name="a31"></a><a class="code" href="a00136.html#aad676c90bbd04d6cc1393d6c93f852c0" title="Set the parameters for polygons rendered on the current frame  GBATEK http://nocash...">glPolyFmt</a>(<a name="a32"></a><a class="code" href="a00136.html#a04ca9bdfcc44641cccf53aa338888b3c" title="used in glPolyFmt() to set the alpha level for the following polygons, set to 0 for...">POLY_ALPHA</a>(31) | <a name="a33"></a><a class="code" href="a00136.html#ac9ed764e909c0619b9abd34fb93f2b3cabd16e90881f219228faa391e2d396a07">POLY_CULL_NONE</a>);
        
        <a name="a34"></a><a class="code" href="a00109.html#af4e9294843965705093b39673ddbb2b4" title="Obtains the current keypad state. Call this function once per main loop in order...">scanKeys</a>();
        
        <a name="a35"></a><a class="code" href="a00121.html#ace9d960e74685e2cd84b36132dbbf8aa" title="16 bit unsigned integer.">u16</a> keys = <a name="a36"></a><a class="code" href="a00109.html#a33346c2b7c7a610aedff2feef9a5240e" title="Obtains the current keypad held state.">keysHeld</a>();
        
        <span class="keywordflow">if</span>((keys &amp; <a name="a37"></a><a class="code" href="a00110.html#aa27cad8fa018a58930b6622783a83072a0848a442d907968b211b97bc2bd88acd" title="Keypad UP button.">KEY_UP</a>)) rotateX += 3;
        <span class="keywordflow">if</span>((keys &amp; <a name="a38"></a><a class="code" href="a00110.html#aa27cad8fa018a58930b6622783a83072aa9cdac7967bf7d88fdb761138a2a3416" title="Keypad DOWN button.">KEY_DOWN</a>)) rotateX -= 3;
        <span class="keywordflow">if</span>((keys &amp; <a name="a39"></a><a class="code" href="a00110.html#aa27cad8fa018a58930b6622783a83072a612120b69c7dfd46086db7aaebdbcf65" title="Keypad LEFT button.">KEY_LEFT</a>)) rotateY += 3;
        <span class="keywordflow">if</span>((keys &amp; <a name="a40"></a><a class="code" href="a00110.html#aa27cad8fa018a58930b6622783a83072a6504370d9c6391e1a9da6a1a529b089d" title="Keypad RIGHT button.">KEY_RIGHT</a>)) rotateY -= 3;
        
        <a name="a41"></a><a class="code" href="a00136.html#af18b10803d5e5da4efa82d6512b440fd" title="throws a packed list of commands into the graphics FIFO via asyncronous DMA  The...">glCallList</a>(triangle);   
        
        <a name="a42"></a><a class="code" href="a00136.html#accbd33aa10c42871ee362357f7d974c8" title="Pops num matrices off the stack  GBATEK http://nocash.emubase.de/gbatek.htm#ds3dmatrixstack...">glPopMatrix</a>(1);
        
        <a name="a43"></a><a class="code" href="a00136.html#a11924dcc21af8cca165a1a553daf9235" title="Waits for a Vblank and swaps the buffers(like swiWaitForVBlank), but lets you specify...">glFlush</a>(0);
        
    }
    
    <span class="keywordflow">return</span> 0;
}<span class="comment">//end main </span>
</pre></div> </div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated on Mon Jul 26 10:36:03 2010 for libnds by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
