<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>libnds: Graphics/3D/nehe/lesson04/source/nehe4.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="docs.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Graphics/3D/nehe/lesson04/source/nehe4.cpp</h1><div class="fragment"><pre class="fragment"><span class="comment">/****************************************</span>
<span class="comment"> *      NDS NeHe Lesson 04              *</span>
<span class="comment"> *      Author: Dovoto                  *</span>
<span class="comment"> ****************************************/</span>

<span class="comment">// include your ndslib</span>
<span class="preprocessor">#include &lt;<a class="code" href="a00119.html" title="the master include file for nds applications.">nds.h</a>&gt;</span>


<span class="keywordtype">int</span> DrawGLScene();

<span class="keywordtype">float</span> rtri;             <span class="comment">// Angle For The Triangle ( NEW )</span>
<span class="keywordtype">float</span> rquad;                <span class="comment">// Angle For The Quad ( NEW )</span>

<span class="keywordtype">int</span> main() {    

    <span class="comment">// Setup the Main screen for 3D </span>
    <a name="a0"></a><a class="code" href="a00135.html#ae3ea5c2e57cc40d6a88e21c4dcb742c8" title="the main 2D engine video mode">videoSetMode</a>(<a name="a1"></a><a class="code" href="a00135.html#a1e46218ee302fcc8c77e4ea0968ea149af75d73d6670d95a0cec81b8e648a0dca" title="3 2D backgrounds 1 3D background (Main engine only)">MODE_0_3D</a>);

    <span class="comment">// initialize the geometry engine</span>
    <a name="a2"></a><a class="code" href="a00136.html#a29390b4085e778ee80b07b46efd4b2ca" title="Initializes the gl state machine (must be called once before using gl calls).">glInit</a>();
    
    <span class="comment">// enable antialiasing</span>
    <a name="a3"></a><a class="code" href="a00136.html#acc179be4d402924ed239617a6aa422f2" title="Enables various gl states (blend, alpha test, etc..).">glEnable</a>(<a name="a4"></a><a class="code" href="a00136.html#a09e37320519ef82d47501185b7a76931aeb3eb07748974534a5a9ab69d190a3ad">GL_ANTIALIAS</a>);
    
    <span class="comment">// setup the rear plane</span>
    <a name="a5"></a><a class="code" href="a00136.html#a47af9a2279197ba4d95467cc0741f117" title="sets the color of the rear-plane(a.k.a Clear Color/Plane)">glClearColor</a>(0,0,0,31); <span class="comment">// BG must be opaque for AA to work</span>
    <a name="a6"></a><a class="code" href="a00136.html#a0316399378018c0409a78580cb1166a9" title="sets the polygon ID of the rear-plane(a.k.a. Clear/Color Plane), useful for antialiasing...">glClearPolyID</a>(63); <span class="comment">// BG must have a unique polygon ID for AA to work</span>
    <a name="a7"></a><a class="code" href="a00136.html#acf0b19102499eed4547a6cac367e51ef" title="reset the depth buffer to this value; generally set this to GL_MAX_DEPTH.  GBATEK...">glClearDepth</a>(0x7FFF);

    <span class="comment">// Set our viewport to be the same size as the screen</span>
    <a name="a8"></a><a class="code" href="a00136.html#a2dca9bf8f906cf5d97f7c11b6e7f3505" title="specify the viewport for following drawing, can be set several times per frame. ...">glViewport</a>(0,0,255,191);
    
    <a name="a9"></a><a class="code" href="a00136.html#a0735cc3f765138aeda473865ee1ecce6" title="change the current matrix mode  GBATEK http://nocash.emubase.de/gbatek.htm#ds3dmatrixloadmultiply...">glMatrixMode</a>(<a name="a10"></a><a class="code" href="a00136.html#a2d4b5d945cec30e7c025823f0447c2b4a9f052b4ec4987e02bae380daff5fa634">GL_PROJECTION</a>);
    <a name="a11"></a><a class="code" href="a00136.html#a3dbf4d6316eb7640e507572fe2612b70" title="loads an identity matrix to the current matrix, same as glIdentity(void)">glLoadIdentity</a>();
    <a name="a12"></a><a class="code" href="a00136.html#ab40589d7691759f889108bd71fbf10b1" title="Utility function which sets up the projection matrix (floating point version).">gluPerspective</a>(70, 256.0 / 192.0, 0.1, 100);
    
    <span class="comment">//ds specific, several attributes can be set here   </span>
    <a name="a13"></a><a class="code" href="a00136.html#aad676c90bbd04d6cc1393d6c93f852c0" title="Set the parameters for polygons rendered on the current frame  GBATEK http://nocash...">glPolyFmt</a>(<a name="a14"></a><a class="code" href="a00136.html#a04ca9bdfcc44641cccf53aa338888b3c" title="used in glPolyFmt() to set the alpha level for the following polygons, set to 0 for...">POLY_ALPHA</a>(31) | <a name="a15"></a><a class="code" href="a00136.html#ac9ed764e909c0619b9abd34fb93f2b3cabd16e90881f219228faa391e2d396a07">POLY_CULL_NONE</a>);
    
    <span class="comment">// Set the current matrix to be the model matrix</span>
    <a class="code" href="a00136.html#a0735cc3f765138aeda473865ee1ecce6" title="change the current matrix mode  GBATEK http://nocash.emubase.de/gbatek.htm#ds3dmatrixloadmultiply...">glMatrixMode</a>(<a name="a16"></a><a class="code" href="a00136.html#a2d4b5d945cec30e7c025823f0447c2b4ab61b6af2524c193dafa434f0d39d5fbb">GL_MODELVIEW</a>);
    
    <span class="keywordflow">while</span> (1) 
    {
        <span class="comment">// draw the scene</span>
        DrawGLScene();
        
        <span class="comment">// flush to screen  </span>
        <a name="a17"></a><a class="code" href="a00136.html#a11924dcc21af8cca165a1a553daf9235" title="Waits for a Vblank and swaps the buffers(like swiWaitForVBlank), but lets you specify...">glFlush</a>(0);
        
        <span class="comment">// wait for the screen to refresh</span>
        <a name="a18"></a><a class="code" href="a00111.html#a1e8361fc4819e3f39d187dc5c29c279a" title="Wait for vblank interrupt.">swiWaitForVBlank</a>();
    }
    
    <span class="keywordflow">return</span> 0;
}

<span class="keywordtype">int</span> DrawGLScene()                                           <span class="comment">// Here&#39;s Where We Do All The Drawing</span>
{
    <span class="comment">/*ds does this automagicaly*/</span><span class="comment">//glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);  // Clear Screen And Depth Buffer</span>
    <a class="code" href="a00136.html#a3dbf4d6316eb7640e507572fe2612b70" title="loads an identity matrix to the current matrix, same as glIdentity(void)">glLoadIdentity</a>();                                   <span class="comment">// Reset The Current Modelview Matrix</span>
    <a name="a19"></a><a class="code" href="a00136.html#a15ee4820b85ebc3888ae2bdde39ed58e" title="multiply the current matrix by a translation matrix  GBATEK http://nocash.emubase...">glTranslatef</a>(-1.5f,0.0f,-6.0f);                     <span class="comment">// Move Left 1.5 Units And Into The Screen 6.0</span>
    <a name="a20"></a><a class="code" href="a00136.html#ac32ef897a20ca720fcde524a50a94ccf" title="Rotate about an arbitrary axis.">glRotatef</a>(rtri,0.0f,1.0f,0.0f);                     <span class="comment">// Rotate The Triangle On The Y axis ( NEW )</span>
    <a name="a21"></a><a class="code" href="a00136.html#af036551b1827883eb67c63d54c196eb1" title="specify a color for following vertices">glColor3f</a>(1, 1, 1);                                 <span class="comment">// set the vertex color</span>
    <a name="a22"></a><a class="code" href="a00136.html#aa767ddea14a9219a8fc2a4a4645eea58" title="Starts a polygon group.">glBegin</a>(<a name="a23"></a><a class="code" href="a00136.html#a0e589918d10f56cda0c48e6f1dd389e9acc7d680eddc73989e6650e72ad0b6ac7">GL_TRIANGLES</a>);                              <span class="comment">// Start Drawing A Triangle</span>
        <a class="code" href="a00136.html#af036551b1827883eb67c63d54c196eb1" title="specify a color for following vertices">glColor3f</a>(1.0f,0.0f,0.0f);                      <span class="comment">// Set Top Point Of Triangle To Red</span>
        <a name="a24"></a><a class="code" href="a00136.html#a9237e35f838d025ed42e566ad237b6da" title="specifies a vertex location">glVertex3f</a>( 0.0f, 1.0f, 0.0f);                  <span class="comment">// First Point Of The Triangle</span>
        <a class="code" href="a00136.html#af036551b1827883eb67c63d54c196eb1" title="specify a color for following vertices">glColor3f</a>(0.0f,1.0f,0.0f);                      <span class="comment">// Set Left Point Of Triangle To Green</span>
        <a class="code" href="a00136.html#a9237e35f838d025ed42e566ad237b6da" title="specifies a vertex location">glVertex3f</a>(-1.0f,-1.0f, 0.0f);                  <span class="comment">// Second Point Of The Triangle</span>
        <a class="code" href="a00136.html#af036551b1827883eb67c63d54c196eb1" title="specify a color for following vertices">glColor3f</a>(0.0f,0.0f,1.0f);                      <span class="comment">// Set Right Point Of Triangle To Blue</span>
        <a class="code" href="a00136.html#a9237e35f838d025ed42e566ad237b6da" title="specifies a vertex location">glVertex3f</a>( 1.0f,-1.0f, 0.0f);                  <span class="comment">// Third Point Of The Triangle</span>
    <a name="a25"></a><a class="code" href="a00136.html#a9ba38906fa947236e63af2a29644775e" title="Ends a polygon group, this seems to be a dummy function that does absolutely nothing...">glEnd</a>();                                            <span class="comment">// Done Drawing The Triangle</span>
    <a class="code" href="a00136.html#a3dbf4d6316eb7640e507572fe2612b70" title="loads an identity matrix to the current matrix, same as glIdentity(void)">glLoadIdentity</a>();                                   <span class="comment">// Reset The Current Modelview Matrix</span>
    <a class="code" href="a00136.html#a15ee4820b85ebc3888ae2bdde39ed58e" title="multiply the current matrix by a translation matrix  GBATEK http://nocash.emubase...">glTranslatef</a>(1.5f,0.0f,-6.0f);                      <span class="comment">// Move Right 1.5 Units And Into The Screen 6.0</span>
    <a class="code" href="a00136.html#ac32ef897a20ca720fcde524a50a94ccf" title="Rotate about an arbitrary axis.">glRotatef</a>(rquad,1.0f,0.0f,0.0f);                    <span class="comment">// Rotate The Quad On The X axis ( NEW )</span>
    <a class="code" href="a00136.html#af036551b1827883eb67c63d54c196eb1" title="specify a color for following vertices">glColor3f</a>(0.5f,0.5f,1.0f);                          <span class="comment">// Set The Color To Blue One Time Only</span>
    <a class="code" href="a00136.html#aa767ddea14a9219a8fc2a4a4645eea58" title="Starts a polygon group.">glBegin</a>(<a name="a26"></a><a class="code" href="a00136.html#a0e589918d10f56cda0c48e6f1dd389e9aab4577ef231a4142312b13d957352ed3">GL_QUADS</a>);                                  <span class="comment">// Draw A Quad</span>
        <a class="code" href="a00136.html#a9237e35f838d025ed42e566ad237b6da" title="specifies a vertex location">glVertex3f</a>(-1.0f, 1.0f, 0.0f);                  <span class="comment">// Top Left</span>
        <a class="code" href="a00136.html#a9237e35f838d025ed42e566ad237b6da" title="specifies a vertex location">glVertex3f</a>( 1.0f, 1.0f, 0.0f);                  <span class="comment">// Top Right</span>
        <a class="code" href="a00136.html#a9237e35f838d025ed42e566ad237b6da" title="specifies a vertex location">glVertex3f</a>( 1.0f,-1.0f, 0.0f);                  <span class="comment">// Bottom Right</span>
        <a class="code" href="a00136.html#a9237e35f838d025ed42e566ad237b6da" title="specifies a vertex location">glVertex3f</a>(-1.0f,-1.0f, 0.0f);                  <span class="comment">// Bottom Left</span>
    <a class="code" href="a00136.html#a9ba38906fa947236e63af2a29644775e" title="Ends a polygon group, this seems to be a dummy function that does absolutely nothing...">glEnd</a>();                                            <span class="comment">// Done Drawing The Quad</span>
    rtri+=0.9f;                                         <span class="comment">// Increase The Rotation Variable For The Triangle ( NEW )</span>
    rquad-=0.75f;                                       <span class="comment">// Decrease The Rotation Variable For The Quad ( NEW )</span>
    <span class="keywordflow">return</span> TRUE;                                        <span class="comment">// Keep Going</span>
}
</pre></div> </div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated on Mon Jul 26 10:36:03 2010 for libnds by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
