<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>libnds: Graphics/Backgrounds/all_in_one/source/advanced.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="docs.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Graphics/Backgrounds/all_in_one/source/advanced.cpp</h1><div class="fragment"><pre class="fragment"><span class="preprocessor">#include &lt;<a class="code" href="a00119.html" title="the master include file for nds applications.">nds.h</a>&gt;</span>

<span class="preprocessor">#include &lt;RotBackgrounds.h&gt;</span>
<span class="preprocessor">#include &lt;TextBackgrounds.h&gt;</span>
<span class="preprocessor">#include &lt;Multilayer.h&gt;</span>

<span class="preprocessor">#include &lt;stdio.h&gt;</span>
<span class="preprocessor">#include &lt;stdlib.h&gt;</span>

<span class="keywordtype">void</span> scroll(<span class="keywordtype">int</span> <span class="keywordtype">id</span>, <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height);

<span class="keywordtype">void</span> advMosaic(<span class="keywordtype">void</span>)
{
    <a name="a0"></a><a class="code" href="a00135.html#ae3ea5c2e57cc40d6a88e21c4dcb742c8" title="the main 2D engine video mode">videoSetMode</a>(<a name="a1"></a><a class="code" href="a00135.html#a1e46218ee302fcc8c77e4ea0968ea149a9cdd63a31b19e5ff101d468d2af31fe6" title="4 2D backgrounds">MODE_0_2D</a>);
    <a name="a2"></a><a class="code" href="a00135.html#a3e86d5c1a90d13eb82cab5d2ef6f52b2" title="Set bank A to the indicated mapping.">vramSetBankA</a>(<a name="a3"></a><a class="code" href="a00135.html#a348d2824280b1b94792407f4920e346aa63f5b895f2a5f54c19babbe2b1a9fe63" title="maps vram a to main engine background slot 0.">VRAM_A_MAIN_BG</a>);
    
    <span class="keywordtype">int</span> bg = <a name="a4"></a><a class="code" href="a00140.html#gaf2ba2b415bf8e02ccc0b30c55f878496" title="Initializes a background on the main display Sets up background control register...">bgInit</a>(0, <a name="a5"></a><a class="code" href="a00140.html#gga421d43ca799fd0c471335846da06cae1a6c229556bb8ab864190671ad29b4f12f" title="8bpp Tiled background with 16 bit tile indexes and no allowed rotation or scaling...">BgType_Text8bpp</a>, <a name="a6"></a><a class="code" href="a00140.html#gga6bd2253ebf93a399fa956a2a7b8b6b3bad0ae6d5acf41d75db8bc77fcb0cbb2d2">BgSize_T_256x256</a>, 0,1);
    
    <a name="a7"></a><a class="code" href="a00101.html#ac77a16a7cb9f2fa2b4361c22fe84245d" title="copies from source to destination using channel 3 of DMA available channels in half...">dmaCopy</a>(TextBackgroundsTiles, <a name="a8"></a><a class="code" href="a00140.html#ga8056a3c13f45f94003e90bd6a86f3a19" title="Gets a pointer to the background graphics.">bgGetGfxPtr</a>(bg), <span class="keyword">sizeof</span>(TextBackgroundsTiles));
    <a class="code" href="a00101.html#ac77a16a7cb9f2fa2b4361c22fe84245d" title="copies from source to destination using channel 3 of DMA available channels in half...">dmaCopy</a>(Layer256x256Map, <a name="a9"></a><a class="code" href="a00140.html#ga375acd93ac465dcc52650cdafb9e74ad" title="Gets a pointer to the background map.">bgGetMapPtr</a>(bg),  Layer256x256MapLen);
    <a class="code" href="a00101.html#ac77a16a7cb9f2fa2b4361c22fe84245d" title="copies from source to destination using channel 3 of DMA available channels in half...">dmaCopy</a>(TextBackgroundsPal, <a name="a10"></a><a class="code" href="a00135.html#affd17d691136b146eea14f7f9385bbf1" title="background palette memory">BG_PALETTE</a>, <span class="keyword">sizeof</span>(TextBackgroundsPal));
    
    <a name="a11"></a><a class="code" href="a00140.html#ga5ffd211c939956483e25b06c4150e186" title="Enables mosaic on the specified background.">bgMosaicEnable</a>(bg);
    
    <span class="keywordtype">int</span> keys = 0;
    <span class="keywordtype">int</span> mosaic_x = 0;
    <span class="keywordtype">int</span> mosaic_y = 0;
    
    <span class="keywordflow">while</span>(!(keys &amp; <a name="a12"></a><a class="code" href="a00110.html#aa27cad8fa018a58930b6622783a83072a10072b5ee7aa1faf316434ecc9e2bb3a" title="Keypad B button.">KEY_B</a>))
    {
        <a name="a13"></a><a class="code" href="a00109.html#af4e9294843965705093b39673ddbb2b4" title="Obtains the current keypad state. Call this function once per main loop in order...">scanKeys</a>();
        keys = <a name="a14"></a><a class="code" href="a00109.html#a53b39b35dd9e47f94dac068da0cfa080" title="Obtains the current keypad pressed state.">keysDown</a>();
        
        <span class="keywordflow">if</span>(keys &amp; <a name="a15"></a><a class="code" href="a00110.html#aa27cad8fa018a58930b6622783a83072a0848a442d907968b211b97bc2bd88acd" title="Keypad UP button.">KEY_UP</a>) mosaic_y--;
        <span class="keywordflow">if</span>(keys &amp; <a name="a16"></a><a class="code" href="a00110.html#aa27cad8fa018a58930b6622783a83072aa9cdac7967bf7d88fdb761138a2a3416" title="Keypad DOWN button.">KEY_DOWN</a>) mosaic_y++;
    
        <span class="keywordflow">if</span>(keys &amp; <a name="a17"></a><a class="code" href="a00110.html#aa27cad8fa018a58930b6622783a83072a612120b69c7dfd46086db7aaebdbcf65" title="Keypad LEFT button.">KEY_LEFT</a>) mosaic_x--;
        <span class="keywordflow">if</span>(keys &amp; <a name="a18"></a><a class="code" href="a00110.html#aa27cad8fa018a58930b6622783a83072a6504370d9c6391e1a9da6a1a529b089d" title="Keypad RIGHT button.">KEY_RIGHT</a>) mosaic_x++;

        <span class="keywordflow">if</span>(mosaic_x &gt; 15) mosaic_x = 15;
        <span class="keywordflow">if</span>(mosaic_x &lt; 0) mosaic_x = 0;
        
        <span class="keywordflow">if</span>(mosaic_y &gt; 15) mosaic_y = 15;
        <span class="keywordflow">if</span>(mosaic_y &lt; 0) mosaic_y = 0;

        
        <a name="a19"></a><a class="code" href="a00111.html#a1e8361fc4819e3f39d187dc5c29c279a" title="Wait for vblank interrupt.">swiWaitForVBlank</a>();
        
        <a name="a20"></a><a class="code" href="a00140.html#ga29a8bd59f8bb3b4fbb5525845f0eed8c" title="Sets the horizontal and vertical mosaic values for all backgrounds.">bgSetMosaic</a>(mosaic_x, mosaic_y);
        
        <a name="a21"></a><a class="code" href="a00096.html#ac62c34a3fa2a6403c690dd80022b3e34" title="Clears the screan by iprintf(&amp;quot;\x1b[2J&amp;quot;);.">consoleClear</a>();
        iprintf(<span class="stringliteral">&quot;Press B to exit\n&quot;</span>);
        iprintf(<span class="stringliteral">&quot;DX: %d  DY: %d&quot;</span>, mosaic_x, mosaic_y);
        
    }
}

<span class="keywordtype">void</span> advRotating(<span class="keywordtype">void</span>)
{
    <a class="code" href="a00135.html#ae3ea5c2e57cc40d6a88e21c4dcb742c8" title="the main 2D engine video mode">videoSetMode</a>(<a name="a22"></a><a class="code" href="a00135.html#a1e46218ee302fcc8c77e4ea0968ea149a0b2ab161193b83723dd8cc633c168fab" title="4 2D backgrounds">MODE_5_2D</a>);
    <a class="code" href="a00135.html#a3e86d5c1a90d13eb82cab5d2ef6f52b2" title="Set bank A to the indicated mapping.">vramSetBankA</a>(<a class="code" href="a00135.html#a348d2824280b1b94792407f4920e346aa63f5b895f2a5f54c19babbe2b1a9fe63" title="maps vram a to main engine background slot 0.">VRAM_A_MAIN_BG</a>);
    
    <span class="keywordtype">int</span> bg = <a class="code" href="a00140.html#gaf2ba2b415bf8e02ccc0b30c55f878496" title="Initializes a background on the main display Sets up background control register...">bgInit</a>(3, <a name="a23"></a><a class="code" href="a00140.html#gga421d43ca799fd0c471335846da06cae1a081723a41affd32616314562b89cdbdd" title="Tiled background with 16 bit tile indexes Can be scaled and rotated.">BgType_ExRotation</a>, <a name="a24"></a><a class="code" href="a00140.html#gga6bd2253ebf93a399fa956a2a7b8b6b3bacc8d5db52e0a673a032d4cfd964818b1">BgSize_ER_256x256</a>, 0,1);
    
    <a class="code" href="a00101.html#ac77a16a7cb9f2fa2b4361c22fe84245d" title="copies from source to destination using channel 3 of DMA available channels in half...">dmaCopy</a>(TextBackgroundsTiles, <a class="code" href="a00140.html#ga8056a3c13f45f94003e90bd6a86f3a19" title="Gets a pointer to the background graphics.">bgGetGfxPtr</a>(bg), <span class="keyword">sizeof</span>(TextBackgroundsTiles));
    <a class="code" href="a00101.html#ac77a16a7cb9f2fa2b4361c22fe84245d" title="copies from source to destination using channel 3 of DMA available channels in half...">dmaCopy</a>(TextBackgroundsPal, <a class="code" href="a00135.html#affd17d691136b146eea14f7f9385bbf1" title="background palette memory">BG_PALETTE</a>, <span class="keyword">sizeof</span>(TextBackgroundsPal));
    <a class="code" href="a00101.html#ac77a16a7cb9f2fa2b4361c22fe84245d" title="copies from source to destination using channel 3 of DMA available channels in half...">dmaCopy</a>(Layer256x256Map, <a class="code" href="a00140.html#ga375acd93ac465dcc52650cdafb9e74ad" title="Gets a pointer to the background map.">bgGetMapPtr</a>(bg),  Layer256x256MapLen);
    
    <a class="code" href="a00140.html#ga5ffd211c939956483e25b06c4150e186" title="Enables mosaic on the specified background.">bgMosaicEnable</a>(bg);
    
    <span class="keywordtype">int</span> keys = 0;
    <span class="keywordtype">int</span> angle = 0;
    <span class="keywordtype">int</span> center_x = 0;
    <span class="keywordtype">int</span> center_y = 0;
    
    <span class="keywordflow">while</span>(!(keys &amp; KEY_B))
    {
        <a class="code" href="a00109.html#af4e9294843965705093b39673ddbb2b4" title="Obtains the current keypad state. Call this function once per main loop in order...">scanKeys</a>();
        keys = <a name="a25"></a><a class="code" href="a00109.html#a33346c2b7c7a610aedff2feef9a5240e" title="Obtains the current keypad held state.">keysHeld</a>();
        
        <span class="keywordflow">if</span>(keys &amp; KEY_UP) center_y--;
        <span class="keywordflow">if</span>(keys &amp; KEY_DOWN) center_y++;
    
        <span class="keywordflow">if</span>(keys &amp; KEY_LEFT) center_x--;
        <span class="keywordflow">if</span>(keys &amp; KEY_RIGHT) center_x++;

        <span class="keywordflow">if</span>(keys &amp; <a name="a26"></a><a class="code" href="a00110.html#aa27cad8fa018a58930b6622783a83072aece16de35a5ea11f9b228c9376bebc62" title="Left shoulder button.">KEY_L</a>) angle-=40;
        <span class="keywordflow">if</span>(keys &amp; <a name="a27"></a><a class="code" href="a00110.html#aa27cad8fa018a58930b6622783a83072aa3ec8a2ffd5b0e200db5ebe7b65515ff" title="Right shoulder button.">KEY_R</a>) angle+=40;

        <span class="keywordflow">if</span>(center_x &gt; 256) center_x = 256;
        <span class="keywordflow">if</span>(center_x &lt; 0) center_x = 0;
        
        <span class="keywordflow">if</span>(center_y &gt; 192) center_y = 192;
        <span class="keywordflow">if</span>(center_y &lt; 0) center_y = 0;

        
        <a class="code" href="a00111.html#a1e8361fc4819e3f39d187dc5c29c279a" title="Wait for vblank interrupt.">swiWaitForVBlank</a>();
        
        <a name="a28"></a><a class="code" href="a00140.html#gaaefceb157400a1b7997ba07cc43650f9" title="Sets the rotation angle of the specified background and updates the transform matrix...">bgSetRotate</a>(bg, angle);
        <a name="a29"></a><a class="code" href="a00140.html#ga70ace440e43e447bc51e2802bac2cb3e" title="Sets the scroll hardware to the specified location.">bgSetScroll</a>(bg, center_x, center_y);
        <a name="a30"></a><a class="code" href="a00140.html#ga6351bab69613e034a883abfd7c4b7164" title="Sets the center of rotation for the supplied background.">bgSetCenter</a>(bg, center_x, center_y);
        <a name="a31"></a><a class="code" href="a00140.html#ga10a22ba4815acf3e345003c1d110f872" title="Must be called once per frame to update scroll/scale/and rotation of backgrounds...">bgUpdate</a>();

        <a class="code" href="a00096.html#ac62c34a3fa2a6403c690dd80022b3e34" title="Clears the screan by iprintf(&amp;quot;\x1b[2J&amp;quot;);.">consoleClear</a>();
        iprintf(<span class="stringliteral">&quot;Press B to exit.n&quot;</span>);
        iprintf(<span class="stringliteral">&quot;Angle: %d \ncenter X: %d  center Y: %d&quot;</span>, <a name="a32"></a><a class="code" href="a00134.html#a40e85edeb59c6edc4ba9831f92af8b2f" title="converts an angle in the format used by libnds in the 360 degree format.">angleToDegrees</a>(angle), center_x, center_y);
        
    }
}
<span class="keywordtype">void</span> advScaling(<span class="keywordtype">void</span>)
{
    <a class="code" href="a00135.html#ae3ea5c2e57cc40d6a88e21c4dcb742c8" title="the main 2D engine video mode">videoSetMode</a>(<a class="code" href="a00135.html#a1e46218ee302fcc8c77e4ea0968ea149a0b2ab161193b83723dd8cc633c168fab" title="4 2D backgrounds">MODE_5_2D</a>);
    <a class="code" href="a00135.html#a3e86d5c1a90d13eb82cab5d2ef6f52b2" title="Set bank A to the indicated mapping.">vramSetBankA</a>(<a class="code" href="a00135.html#a348d2824280b1b94792407f4920e346aa63f5b895f2a5f54c19babbe2b1a9fe63" title="maps vram a to main engine background slot 0.">VRAM_A_MAIN_BG</a>);
    
    <span class="keywordtype">int</span> bg = <a class="code" href="a00140.html#gaf2ba2b415bf8e02ccc0b30c55f878496" title="Initializes a background on the main display Sets up background control register...">bgInit</a>(3, <a class="code" href="a00140.html#gga421d43ca799fd0c471335846da06cae1a081723a41affd32616314562b89cdbdd" title="Tiled background with 16 bit tile indexes Can be scaled and rotated.">BgType_ExRotation</a>, <a class="code" href="a00140.html#gga6bd2253ebf93a399fa956a2a7b8b6b3bacc8d5db52e0a673a032d4cfd964818b1">BgSize_ER_256x256</a>, 0,1);
    
    <a class="code" href="a00101.html#ac77a16a7cb9f2fa2b4361c22fe84245d" title="copies from source to destination using channel 3 of DMA available channels in half...">dmaCopy</a>(TextBackgroundsTiles, <a class="code" href="a00140.html#ga8056a3c13f45f94003e90bd6a86f3a19" title="Gets a pointer to the background graphics.">bgGetGfxPtr</a>(bg), <span class="keyword">sizeof</span>(TextBackgroundsTiles));
    <a class="code" href="a00101.html#ac77a16a7cb9f2fa2b4361c22fe84245d" title="copies from source to destination using channel 3 of DMA available channels in half...">dmaCopy</a>(TextBackgroundsPal, <a class="code" href="a00135.html#affd17d691136b146eea14f7f9385bbf1" title="background palette memory">BG_PALETTE</a>, <span class="keyword">sizeof</span>(TextBackgroundsPal));
    <a class="code" href="a00101.html#ac77a16a7cb9f2fa2b4361c22fe84245d" title="copies from source to destination using channel 3 of DMA available channels in half...">dmaCopy</a>(Layer256x256Map, <a class="code" href="a00140.html#ga375acd93ac465dcc52650cdafb9e74ad" title="Gets a pointer to the background map.">bgGetMapPtr</a>(bg),  Layer256x256MapLen);
    
    <a class="code" href="a00140.html#ga5ffd211c939956483e25b06c4150e186" title="Enables mosaic on the specified background.">bgMosaicEnable</a>(bg);
    
    <span class="keywordtype">int</span> keys = 0;

    <span class="keywordtype">int</span> scale_x = 1 &lt;&lt; 8;
    <span class="keywordtype">int</span> scale_y = 1 &lt;&lt; 8;
    
    <span class="keywordflow">while</span>(!(keys &amp; KEY_B))
    {
        <a class="code" href="a00109.html#af4e9294843965705093b39673ddbb2b4" title="Obtains the current keypad state. Call this function once per main loop in order...">scanKeys</a>();
        keys = <a class="code" href="a00109.html#a33346c2b7c7a610aedff2feef9a5240e" title="Obtains the current keypad held state.">keysHeld</a>();
        
        <span class="keywordflow">if</span>(keys &amp; KEY_UP) scale_y++;
        <span class="keywordflow">if</span>(keys &amp; KEY_DOWN) scale_y--;
    
        <span class="keywordflow">if</span>(keys &amp; KEY_LEFT) scale_x++;
        <span class="keywordflow">if</span>(keys &amp; KEY_RIGHT) scale_x--;

        <a class="code" href="a00111.html#a1e8361fc4819e3f39d187dc5c29c279a" title="Wait for vblank interrupt.">swiWaitForVBlank</a>();
        
        <a name="a33"></a><a class="code" href="a00140.html#gadc941e9c2c02503d10bf69cec3746dc4" title="Sets the scale of the specified background.">bgSetScale</a>(bg, scale_x , scale_y );
        
        <a class="code" href="a00140.html#ga10a22ba4815acf3e345003c1d110f872" title="Must be called once per frame to update scroll/scale/and rotation of backgrounds...">bgUpdate</a>();

        <a class="code" href="a00096.html#ac62c34a3fa2a6403c690dd80022b3e34" title="Clears the screan by iprintf(&amp;quot;\x1b[2J&amp;quot;);.">consoleClear</a>();
        iprintf(<span class="stringliteral">&quot;Press B to exit.n&quot;</span>);
        iprintf(<span class="stringliteral">&quot;scale X: %d  scale Y: %d&quot;</span>, scale_x, scale_y);
        
    }
}
<span class="keywordtype">void</span> advExtendedPalette(<span class="keywordtype">void</span>){}
<span class="keywordtype">void</span> advMultipleLayers(<span class="keywordtype">void</span>)
{
    <a class="code" href="a00135.html#ae3ea5c2e57cc40d6a88e21c4dcb742c8" title="the main 2D engine video mode">videoSetMode</a>(<a class="code" href="a00135.html#a1e46218ee302fcc8c77e4ea0968ea149a0b2ab161193b83723dd8cc633c168fab" title="4 2D backgrounds">MODE_5_2D</a>);
    <a class="code" href="a00135.html#a3e86d5c1a90d13eb82cab5d2ef6f52b2" title="Set bank A to the indicated mapping.">vramSetBankA</a>(<a class="code" href="a00135.html#a348d2824280b1b94792407f4920e346aa63f5b895f2a5f54c19babbe2b1a9fe63" title="maps vram a to main engine background slot 0.">VRAM_A_MAIN_BG</a>);
    
    <span class="comment">//initialize the backgrounds</span>
    <span class="keywordtype">int</span> bg1 = <a class="code" href="a00140.html#gaf2ba2b415bf8e02ccc0b30c55f878496" title="Initializes a background on the main display Sets up background control register...">bgInit</a>(0, <a class="code" href="a00140.html#gga421d43ca799fd0c471335846da06cae1a6c229556bb8ab864190671ad29b4f12f" title="8bpp Tiled background with 16 bit tile indexes and no allowed rotation or scaling...">BgType_Text8bpp</a>, <a class="code" href="a00140.html#gga6bd2253ebf93a399fa956a2a7b8b6b3bacc8d5db52e0a673a032d4cfd964818b1">BgSize_ER_256x256</a>, 0,1);
    <span class="keywordtype">int</span> bg2 = <a class="code" href="a00140.html#gaf2ba2b415bf8e02ccc0b30c55f878496" title="Initializes a background on the main display Sets up background control register...">bgInit</a>(1, <a class="code" href="a00140.html#gga421d43ca799fd0c471335846da06cae1a6c229556bb8ab864190671ad29b4f12f" title="8bpp Tiled background with 16 bit tile indexes and no allowed rotation or scaling...">BgType_Text8bpp</a>, <a class="code" href="a00140.html#gga6bd2253ebf93a399fa956a2a7b8b6b3bacc8d5db52e0a673a032d4cfd964818b1">BgSize_ER_256x256</a>, 1,1);
    <span class="keywordtype">int</span> bg3 = <a class="code" href="a00140.html#gaf2ba2b415bf8e02ccc0b30c55f878496" title="Initializes a background on the main display Sets up background control register...">bgInit</a>(2, <a class="code" href="a00140.html#gga421d43ca799fd0c471335846da06cae1a081723a41affd32616314562b89cdbdd" title="Tiled background with 16 bit tile indexes Can be scaled and rotated.">BgType_ExRotation</a>, <a class="code" href="a00140.html#gga6bd2253ebf93a399fa956a2a7b8b6b3bacc8d5db52e0a673a032d4cfd964818b1">BgSize_ER_256x256</a>, 2,1);
    
    <span class="comment">//make sure the floor is on the bottom (by default hardware layer 0 will be rendered last)</span>
    <a name="a34"></a><a class="code" href="a00140.html#ga96c0d70012f6e7b29eab7f4b51bc4c58" title="Sets the background priority.">bgSetPriority</a>(bg1, 3);
    <a class="code" href="a00140.html#ga96c0d70012f6e7b29eab7f4b51bc4c58" title="Sets the background priority.">bgSetPriority</a>(bg2, 2);
    <a class="code" href="a00140.html#ga96c0d70012f6e7b29eab7f4b51bc4c58" title="Sets the background priority.">bgSetPriority</a>(bg3, 1);
    
    <span class="comment">//they all share tiles and a palette</span>
    <a class="code" href="a00101.html#ac77a16a7cb9f2fa2b4361c22fe84245d" title="copies from source to destination using channel 3 of DMA available channels in half...">dmaCopy</a>(MultilayerTiles, <a class="code" href="a00140.html#ga8056a3c13f45f94003e90bd6a86f3a19" title="Gets a pointer to the background graphics.">bgGetGfxPtr</a>(bg1), <span class="keyword">sizeof</span>(MultilayerTiles));
    <a class="code" href="a00101.html#ac77a16a7cb9f2fa2b4361c22fe84245d" title="copies from source to destination using channel 3 of DMA available channels in half...">dmaCopy</a>(MultilayerPal, <a class="code" href="a00135.html#affd17d691136b146eea14f7f9385bbf1" title="background palette memory">BG_PALETTE</a>, <span class="keyword">sizeof</span>(MultilayerPal));

    <span class="comment">//all we need to do is copy in the maps</span>
    <a class="code" href="a00101.html#ac77a16a7cb9f2fa2b4361c22fe84245d" title="copies from source to destination using channel 3 of DMA available channels in half...">dmaCopy</a>(Layer_1Map, <a class="code" href="a00140.html#ga375acd93ac465dcc52650cdafb9e74ad" title="Gets a pointer to the background map.">bgGetMapPtr</a>(bg1),  Layer_1MapLen);
    <a class="code" href="a00101.html#ac77a16a7cb9f2fa2b4361c22fe84245d" title="copies from source to destination using channel 3 of DMA available channels in half...">dmaCopy</a>(Layer_2Map, <a class="code" href="a00140.html#ga375acd93ac465dcc52650cdafb9e74ad" title="Gets a pointer to the background map.">bgGetMapPtr</a>(bg2),  Layer_2MapLen);
    <a class="code" href="a00101.html#ac77a16a7cb9f2fa2b4361c22fe84245d" title="copies from source to destination using channel 3 of DMA available channels in half...">dmaCopy</a>(Layer_3Map, <a class="code" href="a00140.html#ga375acd93ac465dcc52650cdafb9e74ad" title="Gets a pointer to the background map.">bgGetMapPtr</a>(bg3),  Layer_3MapLen);
    
    <span class="keywordtype">int</span> keys = 0;
    <span class="keywordtype">bool</span> bg1_hidden = <span class="keyword">false</span>;
    <span class="keywordtype">bool</span> bg2_hidden = <span class="keyword">false</span>;
    <span class="keywordtype">bool</span> bg3_hidden = <span class="keyword">false</span>;

    <span class="keywordflow">while</span>(!(keys &amp; KEY_B))
    {
        <a class="code" href="a00109.html#af4e9294843965705093b39673ddbb2b4" title="Obtains the current keypad state. Call this function once per main loop in order...">scanKeys</a>();
        
        keys = <a class="code" href="a00109.html#a53b39b35dd9e47f94dac068da0cfa080" title="Obtains the current keypad pressed state.">keysDown</a>();
        
        <span class="keywordflow">if</span>(keys &amp; KEY_UP) bg1_hidden = !bg1_hidden;
        <span class="keywordflow">if</span>(keys &amp; KEY_DOWN) bg2_hidden = !bg2_hidden;
        <span class="keywordflow">if</span>(keys &amp; KEY_LEFT) bg3_hidden = !bg3_hidden;
        
        <a class="code" href="a00111.html#a1e8361fc4819e3f39d187dc5c29c279a" title="Wait for vblank interrupt.">swiWaitForVBlank</a>();
        
        bg1_hidden ? <a name="a35"></a><a class="code" href="a00140.html#gaf556ce47c4611d7cf094983276d00692" title="Hides the current background via the display control register.">bgHide</a>(bg1) : <a name="a36"></a><a class="code" href="a00140.html#ga2be7f268363f9079bababc6776924e65" title="Shows the current background via the display control register.">bgShow</a>(bg1);
        bg2_hidden ? <a class="code" href="a00140.html#gaf556ce47c4611d7cf094983276d00692" title="Hides the current background via the display control register.">bgHide</a>(bg2) : <a class="code" href="a00140.html#ga2be7f268363f9079bababc6776924e65" title="Shows the current background via the display control register.">bgShow</a>(bg2);
        bg3_hidden ? <a class="code" href="a00140.html#gaf556ce47c4611d7cf094983276d00692" title="Hides the current background via the display control register.">bgHide</a>(bg3) : <a class="code" href="a00140.html#ga2be7f268363f9079bababc6776924e65" title="Shows the current background via the display control register.">bgShow</a>(bg3);
        
        <a class="code" href="a00096.html#ac62c34a3fa2a6403c690dd80022b3e34" title="Clears the screan by iprintf(&amp;quot;\x1b[2J&amp;quot;);.">consoleClear</a>();

        iprintf(<span class="stringliteral">&quot;Press UP DOWN LEFT to toggle the layers\n\n&quot;</span>);
        iprintf(<span class="stringliteral">&quot;Floor (UP): %s\n&quot;</span>, bg1_hidden ? <span class="stringliteral">&quot;hidden&quot;</span> : <span class="stringliteral">&quot;displayed&quot;</span>);
        iprintf(<span class="stringliteral">&quot;Walls (DOWN): %s\n&quot;</span>, bg2_hidden ? <span class="stringliteral">&quot;hidden&quot;</span> : <span class="stringliteral">&quot;displayed&quot;</span>);
        iprintf(<span class="stringliteral">&quot;Decorations (LEFT): %s\n&quot;</span>, bg3_hidden ? <span class="stringliteral">&quot;hidden&quot;</span> : <span class="stringliteral">&quot;displayed&quot;</span>);
    }
}
</pre></div> </div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated on Mon Jul 26 10:36:03 2010 for libnds by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
